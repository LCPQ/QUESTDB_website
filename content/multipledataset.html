---
title: "Multiple dataset"
date: 2019-09-27 16:41
draft: false
---
<script src="/scripts/data.js" type="text/javascript"></script>
<script src="/scripts/loadAllData.js" type="text/javascript"></script>
<script src="/scripts/getFullDataPath.js" type="text/javascript"></script>
<script src="/scripts/getTextFromFile.js" type="text/javascript"></script>
<script src="/scripts/trueTypeOf.js" type="text/javascript"></script>
<script src="/scripts/uniq.js"></script>
<script src="/scripts/noNan.js"></script>
<script src="https://cdn.rawgit.com/larsgw/citation.js/archive/citation.js/citation-0.4.0-9.js"
  type="text/javascript"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<script src="https://unpkg.com/simple-statistics@7.0.2/dist/simple-statistics.min.js"></script>
<script>
  window.onload= async ()=>{
    $('#form input[type=radio]').on('change', async function(event) {
      var result = $(this).val();
      var proms=[];
      switch (result) {
        case "abs":

          proms=getAbsFilesName().map((f) => AbsDataFile.loadAsync(f));
          break;
        case "fluo":
          proms=getFluoFilesName().map((f) => FluoDataFile.loadAsync(f));
          break;
        case "zpe":
          proms=getZPEFilesName().map((f) => ZPEDataFile.loadAsync(f));
          break;
      }
      window.dats=await Promise.all(proms)
      reloadSelect()
      await reloadContent()
    })
  }
  function reloadSelect(){
    $('#form > select').each(function(){
      $(this).find('option[value!=""]').remove()
      const vals=uniq(window.dats.map((d)=>{return d[$(this).attr("name")]}))
      for (const val of vals){
        op=document.createElement("option")
        op.value=JSON.stringify(val)
        op.innerText=val.toString()
        $(this).append(op)
    }
    })
  }
  async function reloadContent(){
    const LatexInline=['\\(','\\)']
    var filt=window.dats
    $('#form > select').each(function(){
      const prop=$(this).attr("name")
      const values=$(this).val()
      filt=filt.filter((d)=>{
        if(typeof values=="undefined" || values==null){
         return false 
        }
        return values.includes(JSON.stringify(d[prop]))
      })
    })
    var dtb=document.getElementById("dat_table_b");
    var stb=document.getElementById("stat_table_b");
    dtb.innerHTML=''
    stb.innerHTML=''
    var sdic=new Map()
    for (const d of filt) {
      var row=document.createElement("tr")
      var rowd=[]
      var els=[d.molecule,d.comment,d.code,d.method,d.DOI]
      for(const el of els){
        td=document.createElement("td")
        td.innerText=el
          row.appendChild(td)
      }
      dtb.appendChild(row)
      row=[]      
      if(!(sdic.has(d.molecule)))
      {
        sdic.set(d.molecule,new Map())
      }
      var exdic=sdic.get(d.molecule)
      for(const exc of d.excitations){
        var key=JSON.stringify([exc.initial,exc.final])
        if(!(exdic.has(key))){
          exdic.set(key,[])
        }
        exdic.get(key).push(exc.value)
      }
    }
    for(const [mol,exs] of sdic){
      var defmol=true
      for (const [exstr,values] of exs) {
        var row=document.createElement("tr")
        if(defmol){
          var td=document.createElement("td")
          td.innerText=mol
          td.rowSpan=exs.leight
          row.appendChild(td)
          defmol=false
        }
        ex=JSON.parse(exstr).map(v=>{
          return Object.setPrototypeOf(v,state.prototype)
        })
        var td=document.createElement("td")
        td.innerText=String.raw`${LatexInline[0]} ${ex[0].toLaTeX()} \rightarrow ${ex[1].toLaTeX()}${LatexInline[1]}`
        row.appendChild(td)
        e=[ss.min(values),ss.max(values),ss.mean(values),ss.median(values),ss.variance(values),ss.standardDeviation(values),ss.medianAbsoluteDeviation(values)]
        e.forEach(v =>{
          td=document.createElement("td")
          td.innerText=noNanPrecision(v,3);
          row.appendChild(td)
        })
        stb.appendChild(row) 
      }
    }
    await MathJax.typesetPromise()
  }
</script>
{{< getDataFilesName >}}
  <form id="form" action="" method="post">
    <legend>Data type</legend>
    <input type="radio" id="abs" value="abs" name="datatype">
    <label for="abs">Absorption</label>
    <input type="radio" id="fluo" value="fluo" name="datatype">
    <label for="fluo">Fluorescence</label>
    <input type="radio" id="zpe" value="zpe" name="datatype">
    <label for="zpe">\(\Delta \text{ZPE}\)</label>
    <br/>
    <label for="mol_select">Molecule</label>
    <select multiple id="mol_select" onchange="reloadContent()" name="molecule"></select>
    <label for="code_select">Code</label>
    <select multiple id="code_select" onchange="reloadContent()" name="code"></select>
    <label for="method_select">Method</label>
    <select multiple id="method_select" onchange="reloadContent()" name="method"></select>
    <label for="DOI_select">DOI</label>
    <select multiple id="DOI_select" onchange="reloadContent()" name="DOI"></select>
  </form>
  <br/>
<div id="data_div">
  <table id="dat_table">
    <thead>
      <th>Molecule</th>
      <th>Comment</th>
      <th>Code</th>
      <th>Method</th>
      <th>DOI</th>
    </thead>
    <tbody id="dat_table_b">
    </tbody>
  </table>
</div>
<div id="stat_div">
  <table id="stat_table">
    <thead>
      <th>Molecule</th>
      <th>Transition</th>
      <th>Min</th>
      <th>Max</th>
      <th>Mean</th>
      <th>Median</th>
      <th>Variance</th>
      <th>Standard deviation</th>
      <th>Median absolute deviation</th>
    </thead>
    <tbody id="stat_table_b">
    </tbody>
  </table>
</div>